<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Lateral Thunking (Posts about python)</title><link>http://brianbaquiran.github.io/</link><description></description><atom:link href="http://brianbaquiran.github.io/categories/python.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 05 Apr 2020 09:32:10 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>My Jupyter Notebook Slides Setup</title><link>http://brianbaquiran.github.io/posts/my-jupyter-notebook-slides-setup/</link><dc:creator>Brian Baquiran</dc:creator><description>&lt;div&gt;&lt;p&gt;Here's how I set up Jupyter notebook for presentations:&lt;/p&gt;
&lt;pre class="literal-block"&gt;pip install jupyter_contrib_nbextensions
jupyter contrib nbextension install --sys-prefix
jupyter nbextension enable splitcell/splitcell
pip install rise
jupyter-nbextension install rise -py --sys-prefix&lt;/pre&gt;
&lt;p&gt;I use Damian Avila's &lt;a class="reference external" href="https://damianavila.github.io/RISE/"&gt;RISE extension&lt;/a&gt;, which saves me from having to write any HTML or JS, allowing me to focus on the
code and figures.&lt;/p&gt;&lt;/div&gt;</description><category>jupyter</category><category>public speaking</category><category>python</category><category>slides</category><guid>http://brianbaquiran.github.io/posts/my-jupyter-notebook-slides-setup/</guid><pubDate>Mon, 26 Feb 2018 08:46:37 GMT</pubDate></item><item><title>Progress bars with tqdm</title><link>http://brianbaquiran.github.io/posts/progress-bars-with-tqdm/</link><dc:creator>Brian Baquiran</dc:creator><description>&lt;div&gt;&lt;p&gt;At your shell:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ pip install tqdm&lt;/pre&gt;
&lt;p&gt;Whenever you iterate over something, wrap it in a &lt;code class="docutils literal"&gt;tqdm&lt;/code&gt; like so:&lt;/p&gt;
&lt;pre class="literal-block"&gt;In [1]: from tqdm import tqdm

In [2]: from time import sleep

In [3]: for i in tqdm(range(1000)):
   ...:     sleep(0.01)
   ...:
      100%|█████████████████████████████████████████████████████████████████████████████| 1000/1000 [00:10&amp;lt;00:00, 98.49it/s]

In [4]:&lt;/pre&gt;&lt;/div&gt;</description><category>programming</category><category>python</category><guid>http://brianbaquiran.github.io/posts/progress-bars-with-tqdm/</guid><pubDate>Sat, 18 Nov 2017 23:27:26 GMT</pubDate></item><item><title>Installing Python 2.7.11 on CentOS 7</title><link>http://brianbaquiran.github.io/posts/installing-python-2711-on-centos-7/</link><dc:creator>Brian Baquiran</dc:creator><description>&lt;div&gt;&lt;p&gt;CentOS 7 ships with python 2.7.5 by default. We have some software that requires 2.7.11. It's generally a bad idea to clobber your system python, since other system-supplied software may rely on it being a particular version.&lt;/p&gt;
&lt;p&gt;Our strategy for running 2.7.11 alongside the system python is to build it from source, then create virtualenvs that will run our software.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://brianbaquiran.github.io/posts/installing-python-2711-on-centos-7/"&gt;Read more…&lt;/a&gt; (1 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><category>centos</category><category>linux</category><category>pydata</category><category>python</category><guid>http://brianbaquiran.github.io/posts/installing-python-2711-on-centos-7/</guid><pubDate>Mon, 23 May 2016 11:17:07 GMT</pubDate></item><item><title>namedtuple Comes in Handy</title><link>http://brianbaquiran.github.io/posts/namedtuple-comes-in-handy/</link><dc:creator>Brian Baquiran</dc:creator><description>&lt;div&gt;&lt;p&gt;I've been writing a lot of Python code recently. Oftentimes I struggle with what a method should return when I have to relay more than one value back to the caller. For example:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PaymentGateway&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-3"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        Perform some transaction against the API.&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :return: whether the transaction was successful or not&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-7"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :rtype: bool&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        """&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-9"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# stuff happens here&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-11"&gt;&lt;/a&gt;            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;amount_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tx_details&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-12"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Success: CODE=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; Details=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;GatewayException&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed: ERROR=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; reason=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;err_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_58d329d0c2ff438cab2d8a8d24a2cf7d-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;The code that calls &lt;code&gt;do_transaction&lt;/code&gt; might look like this:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;payment_gw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;service_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ref_code&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-2"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Hooray! Succe$$!&lt;/span&gt;
&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_success&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction for &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; was successful. Check logs for status code."&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-5"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Boo&lt;/span&gt;
&lt;a name="rest_code_cc404077082f424488e5f6ea262ccee1-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_failure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed. I don't know why..."&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Many times this is fine, but what if the caller needs the details from the &lt;code&gt;amount_transaction&lt;/code&gt; result or the &lt;code&gt;GatewayException&lt;/code&gt;? A quick solution is to return a &lt;code&gt;dict&lt;/code&gt; :&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PaymentGateway&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-3"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        Perform some transaction against the API.&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :return: a dict that contains keys 'success', 'code', and 'detail'&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-7"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :rtype: dict&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        """&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-9"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# stuff happens here&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-11"&gt;&lt;/a&gt;            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;amount_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tx_details&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-12"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Success: CODE=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; Details=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-13"&gt;&lt;/a&gt;            &lt;span class="n"&gt;success_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-14"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'success'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-15"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'code'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-16"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'detail'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-17"&gt;&lt;/a&gt;            &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-18"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;success_dict&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-19"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;GatewayException&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-20"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed: ERROR=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; reason=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;err_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-21"&gt;&lt;/a&gt;            &lt;span class="n"&gt;error_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-22"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'success'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-23"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'code'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;err_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-24"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'detail'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-25"&gt;&lt;/a&gt;            &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_2b246343f2344f288aa671bbe8f63a49-26"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;error_dict&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;It works but it's pretty ad-hoc. The structure of whatever &lt;code&gt;do_transaction&lt;/code&gt; returns won't be obvious unless you dig into the code. The caller will end up like:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;payment_status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;payment_gw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;service_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ref_code&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'success'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-3"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Hooray! Succe$$!&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_success&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction for &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; was successful, status code &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'code'&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-6"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Boo&lt;/span&gt;
&lt;a name="rest_code_8a94622ab5b94e3eb6b695fa3de945ad-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_failure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed, because: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'detail'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Now the caller is poluted with literal strings like &lt;code&gt;'success'&lt;/code&gt;, &lt;code&gt;'code'&lt;/code&gt; and &lt;code&gt;'status'&lt;/code&gt;. These can be hell to debug, specially if you happen to misspell one of them in your code. Even if you're using an awesome IDE like &lt;a class="reference external" href="http://www.jetbrains.com/pycharm/"&gt;PyCharm&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An altenative to defining these ad-hoc dict structures is to use &lt;a class="reference external" href="https://docs.python.org/2/library/collections.html#collections.namedtuple"&gt;namedtuple&lt;/a&gt; from the collections package.&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;PaymentStatus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;namedtuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'PaymentStatus'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'success'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'code'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'detail'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;PaymentGateway&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-7"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        Perform some transaction against the API.&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :return: whether the transaction was successful or not&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        :rtype: PaymentStatus&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        """&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-13"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;# stuff happens here&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;amount_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tx_details&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-16"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Success: CODE=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; Details=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-17"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;PaymentStatus&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;GatewayException&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-19"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed: ERROR=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; reason=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;err_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_16b65a635a084244b9e0fd65ab39be54-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;PaymentStatus&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;err_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;code&gt;namedtuple&lt;/code&gt; forces us to be explicit about what &lt;code&gt;do_transaction&lt;/code&gt; returns. And &lt;a class="reference external" href="http://www.thezenofpython.com/"&gt;explicit is better than implicit&lt;/a&gt;. For the caller, this looks like:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;payment_status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;payment_gw&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_transaction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bill_code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;service_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ref_code&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;success&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-3"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Hooray! Succe$$!&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_success&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction for &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; was successful, status code &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;subid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-6"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# Boo&lt;/span&gt;
&lt;a name="rest_code_385530ecf0954c7a9a7641b98b8263f4-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;report_failure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Transaction failed, because: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;payment_status&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;detail&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;This is almost as simple as our first example, and is free of string literals. And if you're using PyCharm, you can take advantage of the code completion which will know about the attributes of your new &lt;code&gt;namedtuple&lt;/code&gt; class:&lt;/p&gt;
&lt;img alt="/images/pycharm_namedtuple.png" src="http://brianbaquiran.github.io/images/pycharm_namedtuple.png"&gt;
&lt;p&gt;So if your code is littered with string literals as keys for return values from methods that return &lt;code&gt;dict&lt;/code&gt;, consider having them return a &lt;code&gt;namedtuple&lt;/code&gt; instead.&lt;/p&gt;&lt;/div&gt;</description><category>coding</category><category>namedtuple</category><category>PyCharm</category><category>python</category><guid>http://brianbaquiran.github.io/posts/namedtuple-comes-in-handy/</guid><pubDate>Sun, 20 Dec 2015 00:58:42 GMT</pubDate></item></channel></rss>